<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Medidor Completo - Photobooth</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f0f0f0;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
        }
        .upload-area {
            border: 2px dashed #ccc;
            padding: 40px;
            text-align: center;
            margin: 20px 0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }
        .upload-area:hover {
            border-color: #007bff;
            background: #f8fbff;
        }
        #templateImage {
            max-width: 100%;
            max-height: 70vh;
            display: none;
            margin: 0 auto;
        }
        #imageContainer {
            position: relative;
            display: inline-block;
            margin: 0 auto;
        }
        .area-box {
            position: absolute;
            border: 3px solid;
            background: rgba(255, 0, 0, 0.2);
            cursor: move;
        }
        .area-box[data-area="1"] { border-color: #ff0000; }
        .area-box[data-area="2"] { border-color: #00ff00; }
        .area-box[data-area="3"] { border-color: #0000ff; }
        
        .area-label {
            position: absolute;
            top: -30px;
            left: 0;
            color: white;
            padding: 2px 8px;
            font-size: 12px;
            border-radius: 3px;
            font-weight: bold;
        }
        .area-box[data-area="1"] .area-label { background: #ff0000; }
        .area-box[data-area="2"] .area-label { background: #00ff00; color: #000; }
        .area-box[data-area="3"] .area-label { background: #0000ff; }
        
        .resize-handle {
            position: absolute;
            width: 12px;
            height: 12px;
            background: white;
            border: 2px solid;
            border-radius: 2px;
            cursor: nwse-resize;
        }
        .resize-handle.ne { cursor: nesw-resize; }
        .resize-handle.nw { cursor: nwse-resize; }
        .resize-handle.se { cursor: nwse-resize; }
        .resize-handle.sw { cursor: nesw-resize; }
        
        .resize-handle.n { top: -6px; left: 50%; margin-left: -6px; cursor: ns-resize; }
        .resize-handle.e { top: 50%; right: -6px; margin-top: -6px; cursor: ew-resize; }
        .resize-handle.s { bottom: -6px; left: 50%; margin-left: -6px; cursor: ns-resize; }
        .resize-handle.w { top: 50%; left: -6px; margin-top: -6px; cursor: ew-resize; }
        .resize-handle.ne { top: -6px; right: -6px; }
        .resize-handle.nw { top: -6px; left: -6px; }
        .resize-handle.se { bottom: -6px; right: -6px; }
        .resize-handle.sw { bottom: -6px; left: -6px; }
        
        .coordinates {
            background: #333;
            color: white;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
            font-family: monospace;
            white-space: pre-wrap;
        }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: background 0.3s;
        }
        button:hover {
            background: #0056b3;
        }
        .instructions {
            background: #e7f3ff;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
            line-height: 1.5;
        }
        .controls {
            text-align: center;
            margin: 20px 0;
        }
        .area-color {
            display: inline-block;
            width: 12px;
            height: 12px;
            margin-right: 5px;
            border-radius: 2px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üìè Medidor Completo - Photobooth</h1>
        
        <div class="instructions">
            <h3>üéØ Como usar:</h3>
            <ol>
                <li><strong>Carregue seu template</strong> (moldura 3375x6000 pixels)</li>
                <li><strong>Adicione as √°reas</strong> para cada foto (1, 2, 3)</li>
                <li><strong>Arraste</strong> as caixas para posicionar nos espa√ßos certos</li>
                <li><strong>Redimensione</strong> puxando os cantinhos (‚úì igual Canva)</li>
                <li><strong>Copie as coordenadas</strong> para colar no c√≥digo</li>
            </ol>
            <p><strong>üí° Dica:</strong> Use os cantinhos para ajustar perfeitamente nos espa√ßos vazios!</p>
        </div>

        <div class="upload-area" id="uploadArea">
            <p>üìÅ <strong>Clique aqui para carregar seu template</strong></p>
            <p style="font-size: 14px; color: #666;">Dimens√µes: 3375 √ó 6000 pixels</p>
            <input type="file" id="fileInput" accept="image/*" style="display: none;">
        </div>

        <div id="imageContainer" style="display: none; text-align: center;">
            <img id="templateImage" alt="Template">
        </div>

        <div class="controls">
            <button onclick="addArea(1)"><span class="area-color" style="background:#ff0000"></span>Adicionar √Årea Foto 1</button>
            <button onclick="addArea(2)"><span class="area-color" style="background:#00ff00"></span>Adicionar √Årea Foto 2</button>
            <button onclick="addArea(3)"><span class="area-color" style="background:#0000ff"></span>Adicionar √Årea Foto 3</button>
            <button onclick="resetAreas()" style="background: #dc3545;">üóëÔ∏è Limpar Tudo</button>
        </div>

        <div class="coordinates">
            <h3>üìã Coordenadas para o C√≥digo:</h3>
            <pre id="coordinatesOutput">Aguardando defini√ß√£o das √°reas...</pre>
        </div>

        <div style="text-align: center;">
            <button onclick="copyCoordinates()" style="background: #28a745;">üìã Copiar Coordenadas</button>
            <button onclick="downloadConfig()" style="background: #ff6b00;">üíæ Baixar Configura√ß√£o</button>
        </div>
    </div>

    <script>
        let areas = [];
        let currentArea = null;
        let isDragging = false;
        let isResizing = false;
        let resizeDirection = null;
        let startX, startY, startWidth, startHeight, startLeft, startTop;

        // Carregar imagem
        document.getElementById('uploadArea').addEventListener('click', () => {
            document.getElementById('fileInput').click();
        });

        document.getElementById('fileInput').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const img = document.getElementById('templateImage');
                    img.src = e.target.result;
                    img.style.display = 'block';
                    document.getElementById('imageContainer').style.display = 'block';
                    document.getElementById('uploadArea').style.display = 'none';
                    
                    img.onload = function() {
                        resetAreas();
                    };
                };
                reader.readAsDataURL(file);
            }
        });

        function addArea(number) {
            const img = document.getElementById('templateImage');
            const container = document.getElementById('imageContainer');
            
            // Remove √°rea existente com mesmo n√∫mero
            areas = areas.filter(area => area.number !== number);
            document.querySelectorAll(`[data-area="${number}"]`).forEach(el => el.remove());
            
            // Cria nova √°rea
            const areaBox = document.createElement('div');
            areaBox.className = 'area-box';
            areaBox.dataset.area = number;
            
            const label = document.createElement('div');
            label.className = 'area-label';
            label.textContent = `Foto ${number}`;
            label.innerHTML = `üì∏ Foto ${number}`;
            
            // Tamanho padr√£o baseado nas dimens√µes da imagem
            const width = img.width * 0.25;
            const height = img.height * 0.15;
            const x = (img.width - width) / 2;
            const y = img.height * (0.2 + (number-1) * 0.25);
            
            areaBox.style.left = x + 'px';
            areaBox.style.top = y + 'px';
            areaBox.style.width = width + 'px';
            areaBox.style.height = height + 'px';
            
            areaBox.appendChild(label);
            
            // Adiciona al√ßas de redimensionamento
            const handles = ['n', 'e', 's', 'w', 'ne', 'nw', 'se', 'sw'];
            handles.forEach(dir => {
                const handle = document.createElement('div');
                handle.className = `resize-handle ${dir}`;
                handle.dataset.direction = dir;
                areaBox.appendChild(handle);
                
                // Eventos de redimensionamento
                handle.addEventListener('mousedown', (e) => startResize(e, dir, number));
                handle.addEventListener('touchstart', (e) => startResize(e, dir, number));
            });
            
            container.appendChild(areaBox);
            
            // Eventos de arrastar
            areaBox.addEventListener('mousedown', (e) => startDrag(e, number));
            areaBox.addEventListener('touchstart', (e) => startDrag(e, number));
            
            // Salva √°rea
            areas.push({
                number: number,
                x: x,
                y: y,
                width: width,
                height: height
            });
            
            updateCoordinates();
        }

        function startDrag(e, number) {
            if (e.target.classList.contains('resize-handle')) return;
            
            e.preventDefault();
            isDragging = true;
            currentArea = number;
            
            const areaBox = document.querySelector(`[data-area="${number}"]`);
            const rect = areaBox.getBoundingClientRect();
            const container = document.getElementById('imageContainer').getBoundingClientRect();
            
            startX = (e.clientX || e.touches[0].clientX) - rect.left;
            startY = (e.clientY || e.touches[0].clientY) - rect.top;
            startLeft = parseInt(areaBox.style.left);
            startTop = parseInt(areaBox.style.top);
            
            document.addEventListener('mousemove', drag);
            document.addEventListener('touchmove', drag);
            document.addEventListener('mouseup', stopDrag);
            document.addEventListener('touchend', stopDrag);
        }

        function drag(e) {
            if (!isDragging || !currentArea) return;
            
            const container = document.getElementById('imageContainer').getBoundingClientRect();
            const areaBox = document.querySelector(`[data-area="${currentArea}"]`);
            
            const x = (e.clientX || e.touches[0].clientX) - container.left - startX;
            const y = (e.clientY || e.touches[0].clientY) - container.top - startY;
            
            // Limita dentro da imagem
            const maxX = container.width - areaBox.offsetWidth;
            const maxY = container.height - areaBox.offsetHeight;
            
            areaBox.style.left = Math.max(0, Math.min(x, maxX)) + 'px';
            areaBox.style.top = Math.max(0, Math.min(y, maxY)) + 'px';
            
            // Atualiza coordenadas
            const areaIndex = areas.findIndex(a => a.number === currentArea);
            if (areaIndex !== -1) {
                areas[areaIndex].x = parseInt(areaBox.style.left);
                areas[areaIndex].y = parseInt(areaBox.style.top);
                updateCoordinates();
            }
        }

        function startResize(e, direction, number) {
            e.preventDefault();
            e.stopPropagation();
            
            isResizing = true;
            resizeDirection = direction;
            currentArea = number;
            
            const areaBox = document.querySelector(`[data-area="${number}"]`);
            const container = document.getElementById('imageContainer').getBoundingClientRect();
            
            startX = e.clientX || e.touches[0].clientX;
            startY = e.clientY || e.touches[0].clientY;
            startLeft = parseInt(areaBox.style.left);
            startTop = parseInt(areaBox.style.top);
            startWidth = parseInt(areaBox.style.width);
            startHeight = parseInt(areaBox.style.height);
            
            document.addEventListener('mousemove', resize);
            document.addEventListener('touchmove', resize);
            document.addEventListener('mouseup', stopResize);
            document.addEventListener('touchend', stopResize);
        }

        function resize(e) {
            if (!isResizing || !currentArea) return;
            
            const areaBox = document.querySelector(`[data-area="${currentArea}"]`);
            const container = document.getElementById('imageContainer').getBoundingClientRect();
            
            const deltaX = (e.clientX || e.touches[0].clientX) - startX;
            const deltaY = (e.clientY || e.touches[0].clientY) - startY;
            
            let newLeft = startLeft;
            let newTop = startTop;
            let newWidth = startWidth;
            let newHeight = startHeight;
            
            // L√≥gica de redimensionamento baseada na dire√ß√£o
            switch(resizeDirection) {
                case 'e':
                    newWidth = Math.max(50, startWidth + deltaX);
                    break;
                case 'w':
                    newWidth = Math.max(50, startWidth - deltaX);
                    newLeft = startLeft + deltaX;
                    break;
                case 's':
                    newHeight = Math.max(50, startHeight + deltaY);
                    break;
                case 'n':
                    newHeight = Math.max(50, startHeight - deltaY);
                    newTop = startTop + deltaY;
                    break;
                case 'se':
                    newWidth = Math.max(50, startWidth + deltaX);
                    newHeight = Math.max(50, startHeight + deltaY);
                    break;
                case 'sw':
                    newWidth = Math.max(50, startWidth - deltaX);
                    newHeight = Math.max(50, startHeight + deltaY);
                    newLeft = startLeft + deltaX;
                    break;
                case 'ne':
                    newWidth = Math.max(50, startWidth + deltaX);
                    newHeight = Math.max(50, startHeight - deltaY);
                    newTop = startTop + deltaY;
                    break;
                case 'nw':
                    newWidth = Math.max(50, startWidth - deltaX);
                    newHeight = Math.max(50, startHeight - deltaY);
                    newLeft = startLeft + deltaX;
                    newTop = startTop + deltaY;
                    break;
            }
            
            // Limita dentro do container
            const maxLeft = container.width - newWidth;
            const maxTop = container.height - newHeight;
            
            newLeft = Math.max(0, Math.min(newLeft, maxLeft));
            newTop = Math.max(0, Math.min(newTop, maxTop));
            newWidth = Math.min(newWidth, container.width - newLeft);
            newHeight = Math.min(newHeight, container.height - newTop);
            
            areaBox.style.left = newLeft + 'px';
            areaBox.style.top = newTop + 'px';
            areaBox.style.width = newWidth + 'px';
            areaBox.style.height = newHeight + 'px';
            
            // Atualiza coordenadas
            const areaIndex = areas.findIndex(a => a.number === currentArea);
            if (areaIndex !== -1) {
                areas[areaIndex].x = newLeft;
                areas[areaIndex].y = newTop;
                areas[areaIndex].width = newWidth;
                areas[areaIndex].height = newHeight;
                updateCoordinates();
            }
        }

        function stopDrag() {
            isDragging = false;
            currentArea = null;
            document.removeEventListener('mousemove', drag);
            document.removeEventListener('touchmove', drag);
        }

        function stopResize() {
            isResizing = false;
            resizeDirection = null;
            currentArea = null;
            document.removeEventListener('mousemove', resize);
            document.removeEventListener('touchmove', resize);
        }

        function updateCoordinates() {
            const output = document.getElementById('coordinatesOutput');
            if (areas.length === 0) {
                output.textContent = 'Aguardando defini√ß√£o das √°reas...';
                return;
            }
            
            let text = '// COORDENADAS PARA COLAR NO pc.html\n';
            text += 'const photoAreas = [\n';
            
            areas.sort((a, b) => a.number - b.number).forEach(area => {
                text += `  {\n`;
                text += `    number: ${area.number},\n`;
                text += `    x: ${Math.round(area.x)},\n`;
                text += `    y: ${Math.round(area.y)},\n`;
                text += `    width: ${Math.round(area.width)},\n`;
                text += `    height: ${Math.round(area.height)}\n`;
                text += `  }${area.number < 3 ? ',' : ''}\n`;
            });
            
            text += '];';
            output.textContent = text;
        }

        function resetAreas() {
            areas = [];
            document.querySelectorAll('.area-box').forEach(el => el.remove());
            updateCoordinates();
        }

        function copyCoordinates() {
            const text = document.getElementById('coordinatesOutput').textContent;
            navigator.clipboard.writeText(text).then(() => {
                alert('‚úÖ Coordenadas copiadas! Agora cole no c√≥digo pc.html');
            });
        }

        function downloadConfig() {
            const config = {
                templateSize: { width: 3375, height: 6000 },
                areas: areas.sort((a, b) => a.number - b.number)
            };
            
            const blob = new Blob([JSON.stringify(config, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'photobooth-config.json';
            a.click();
            URL.revokeObjectURL(url);
        }
    </script>
</body>
</html>
